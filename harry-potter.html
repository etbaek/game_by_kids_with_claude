<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Harry Potter Magic</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }

        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: 'Georgia', serif;
            overflow: hidden;
        }

        .nav-btn {
            position: fixed;
            top: 15px;
            right: 15px;
            padding: 10px 20px;
            background: rgba(255, 215, 0, 0.3);
            border: none;
            border-radius: 25px;
            color: #ffd700;
            font-size: 14px;
            cursor: pointer;
            text-decoration: none;
            z-index: 100;
        }

        .game-header {
            position: fixed;
            top: 15px;
            left: 15px;
            display: flex;
            gap: 15px;
            z-index: 100;
        }

        .stat-box {
            background: rgba(0, 0, 0, 0.6);
            padding: 10px 20px;
            border-radius: 10px;
            color: #ffd700;
            font-size: 16px;
            border: 2px solid #ffd700;
        }

        #gameCanvas {
            display: block;
        }

        .spell-display {
            position: fixed;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            z-index: 100;
        }

        .spell-name {
            font-size: 32px;
            color: #ffd700;
            text-shadow: 0 0 20px #ffd700;
            margin-bottom: 10px;
        }

        .spell-hint {
            font-size: 18px;
            color: #888;
        }

        .spell-letters {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin-top: 15px;
        }

        .letter-box {
            width: 40px;
            height: 50px;
            background: rgba(255, 215, 0, 0.1);
            border: 2px solid #ffd700;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: #ffd700;
            text-transform: uppercase;
        }

        .letter-box.filled {
            background: rgba(255, 215, 0, 0.3);
        }

        .letter-box.correct {
            background: rgba(34, 197, 94, 0.5);
            border-color: #22c55e;
            color: #22c55e;
        }

        .letter-box.wrong {
            background: rgba(239, 68, 68, 0.5);
            border-color: #ef4444;
            color: #ef4444;
            animation: shake 0.3s;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .keyboard {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            flex-direction: column;
            gap: 8px;
            z-index: 100;
        }

        .keyboard-row {
            display: flex;
            gap: 5px;
            justify-content: center;
        }

        .key {
            width: 35px;
            height: 45px;
            background: rgba(255, 215, 0, 0.2);
            border: 2px solid #ffd700;
            border-radius: 8px;
            color: #ffd700;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.1s;
        }

        .key:active {
            background: rgba(255, 215, 0, 0.5);
            transform: scale(0.95);
        }

        .key.used {
            opacity: 0.3;
        }

        .result-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 48px;
            color: #ffd700;
            text-shadow: 0 0 30px #ffd700;
            pointer-events: none;
            opacity: 0;
            z-index: 150;
        }

        .result-popup.show {
            animation: magicPop 1.5s ease-out forwards;
        }

        @keyframes magicPop {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
            20% { opacity: 1; transform: translate(-50%, -50%) scale(1.3); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(1); }
        }

        .start-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 200;
        }

        .start-screen.hide {
            display: none;
        }

        .title {
            font-size: 42px;
            color: #ffd700;
            text-shadow: 0 0 30px #ffd700;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 20px;
            color: #888;
            margin-bottom: 30px;
        }

        .wand-icon {
            font-size: 80px;
            margin-bottom: 30px;
            animation: wandFloat 2s infinite ease-in-out;
        }

        @keyframes wandFloat {
            0%, 100% { transform: rotate(-10deg); }
            50% { transform: rotate(10deg); }
        }

        .start-btn {
            padding: 15px 50px;
            font-size: 22px;
            background: linear-gradient(135deg, #ffd700, #ff8c00);
            border: none;
            border-radius: 30px;
            color: #1a1a2e;
            font-weight: bold;
            cursor: pointer;
        }

        .spell-list {
            color: #666;
            font-size: 14px;
            margin-top: 30px;
            text-align: center;
            line-height: 1.8;
        }

        .game-over-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 200;
        }

        .game-over-screen.show {
            display: flex;
        }

        .final-title {
            font-size: 36px;
            color: #ffd700;
            margin-bottom: 20px;
        }

        .final-score {
            font-size: 24px;
            color: #888;
            margin-bottom: 30px;
        }

        .restart-btn {
            padding: 15px 40px;
            font-size: 20px;
            background: linear-gradient(135deg, #ffd700, #ff8c00);
            border: none;
            border-radius: 30px;
            color: #1a1a2e;
            font-weight: bold;
            cursor: pointer;
        }

        .magic-particles {
            position: fixed;
            pointer-events: none;
            z-index: 50;
        }

        .particle {
            position: absolute;
            font-size: 20px;
            animation: particleFade 1s forwards;
        }

        @keyframes particleFade {
            0% { opacity: 1; transform: translateY(0) scale(1); }
            100% { opacity: 0; transform: translateY(-50px) scale(0.5); }
        }

        @media (max-width: 400px) {
            .key {
                width: 28px;
                height: 38px;
                font-size: 14px;
            }
            .letter-box {
                width: 32px;
                height: 42px;
                font-size: 20px;
            }
            .spell-name {
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <a href="index.html" class="nav-btn">üè† Ìôà</a>

    <div class="game-header">
        <div class="stat-box">‚≠ê Ï†êÏàò: <span id="score">0</span></div>
        <div class="stat-box">ü™Ñ Î†àÎ≤®: <span id="level">1</span></div>
    </div>

    <canvas id="gameCanvas"></canvas>

    <div class="spell-display" id="spellDisplay">
        <div class="spell-name" id="spellName">Î£®Î™®Ïä§</div>
        <div class="spell-hint" id="spellHint">ÎπõÏùÑ Î∞ùÌûàÎäî Ï£ºÎ¨∏</div>
        <div class="spell-letters" id="spellLetters"></div>
    </div>

    <div class="keyboard" id="keyboard"></div>

    <div class="result-popup" id="resultPopup"></div>
    <div class="magic-particles" id="particles"></div>

    <div class="start-screen" id="startScreen">
        <div class="title">Harry Potter Magic</div>
        <div class="subtitle">ÎßàÎ≤ï Ï£ºÎ¨∏ÏùÑ Ïô∏ÏõåÎùº!</div>
        <div class="wand-icon">ü™Ñ</div>
        <button class="start-btn" onclick="startGame()">ÏãúÏûë!</button>
        <div class="spell-list">
            Î£®Î™®Ïä§, ÏùµÏä§Ìé†Î¶¨ÏïÑÎ¨¥Ïä§, ÏúôÍ∞ÄÎ•¥ÎîîÏõÄ Î†àÎπÑÏò§ÏÇ¨...<br>
            Ï£ºÎ¨∏ÏùÑ Ï†ïÌôïÌûà ÏûÖÎ†•ÌïòÏÑ∏Ïöî!
        </div>
    </div>

    <div class="game-over-screen" id="gameOverScreen">
        <div class="final-title">üßô ÌõåÎ•≠Ìïú ÎßàÎ≤ïÏÇ¨!</div>
        <div class="final-score">
            Ï†êÏàò: <span id="finalScore">0</span><br>
            ÎßàÏä§ÌÑ∞Ìïú Ï£ºÎ¨∏: <span id="spellCount">0</span>Í∞ú
        </div>
        <button class="restart-btn" onclick="restartGame()">Îã§Ïãú Ïó∞Ïäµ</button>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // Spells
        const spells = [
            { name: 'Î£®Î™®Ïä§', english: 'LUMOS', hint: 'ÎπõÏùÑ Î∞ùÌûàÎäî Ï£ºÎ¨∏', effect: 'üí°' },
            { name: 'ÎÖπÏä§', english: 'NOX', hint: 'ÎπõÏùÑ ÎÅÑÎäî Ï£ºÎ¨∏', effect: 'üåë' },
            { name: 'ÏïåÎ°úÌò∏Î™®Îùº', english: 'ALOHOMORA', hint: 'ÏûêÎ¨ºÏá†Î•º Ïó¨Îäî Ï£ºÎ¨∏', effect: 'üîì' },
            { name: 'ÏùµÏä§Ìé†Î¶¨ÏïÑÎ¨¥Ïä§', english: 'EXPELLIARMUS', hint: 'Î¨¥Ïû•Ìï¥Ï†ú Ï£ºÎ¨∏', effect: '‚ö°' },
            { name: 'Ïä§Ìà¨ÌéòÌååÏù¥', english: 'STUPEFY', hint: 'Í∏∞Ï†àÏãúÌÇ§Îäî Ï£ºÎ¨∏', effect: 'üí´' },
            { name: 'ÏïÑÌÅ¨ÏãúÏò§', english: 'ACCIO', hint: 'Î¨ºÍ±¥ÏùÑ Î∂ÄÎ•¥Îäî Ï£ºÎ¨∏', effect: 'üß≤' },
            { name: 'Î†àÌé†Î°ú', english: 'REPELLO', hint: 'Î∞ÄÏñ¥ÎÇ¥Îäî Ï£ºÎ¨∏', effect: 'üí®' },
            { name: 'ÌîÑÎ°úÌÖåÍ≥†', english: 'PROTEGO', hint: 'Î≥¥Ìò∏Îßâ Ï£ºÎ¨∏', effect: 'üõ°Ô∏è' },
            { name: 'ÌéòÌä∏Î¶¨ÌîºÏø†Ïä§', english: 'PETRIFICUS', hint: 'Î™∏ÏùÑ Íµ≥ÌûàÎäî Ï£ºÎ¨∏', effect: 'üóø' },
            { name: 'Ïò§Î∏îÎ¶¨ÎπÑÏóêÏù¥Ìä∏', english: 'OBLIVIATE', hint: 'Í∏∞ÏñµÏùÑ ÏßÄÏö∞Îäî Ï£ºÎ¨∏', effect: 'üß†' },
            { name: 'ÏùµÏä§ÌéôÌÜ†', english: 'EXPECTO', hint: 'Ìå®Ìä∏Î°úÎàÑÏä§ ÏÜåÌôò', effect: 'ü¶å' },
            { name: 'Î¶¨ÎîîÏø®Î£®Ïä§', english: 'RIDDIKULUS', hint: 'Î≥¥Í∞ÄÌä∏ Ìá¥Ïπò Ï£ºÎ¨∏', effect: 'üòÇ' }
        ];

        let gameRunning = false;
        let score = 0;
        let level = 1;
        let spellsCompleted = 0;
        let currentSpell = null;
        let currentInput = '';
        let usedKeys = [];
        let lives = 3;

        // Create keyboard
        const keyboardRows = [
            'QWERTYUIOP',
            'ASDFGHJKL',
            'ZXCVBNM'
        ];

        function createKeyboard() {
            const keyboard = document.getElementById('keyboard');
            keyboard.innerHTML = keyboardRows.map(row => `
                <div class="keyboard-row">
                    ${row.split('').map(key => `
                        <div class="key" data-key="${key}">${key}</div>
                    `).join('')}
                </div>
            `).join('');

            keyboard.querySelectorAll('.key').forEach(key => {
                key.addEventListener('click', () => pressKey(key.dataset.key));
                key.addEventListener('touchstart', e => {
                    e.preventDefault();
                    pressKey(key.dataset.key);
                });
            });
        }

        // Physical keyboard
        document.addEventListener('keydown', e => {
            if (!gameRunning) return;
            const key = e.key.toUpperCase();
            if (/^[A-Z]$/.test(key)) {
                pressKey(key);
            }
        });

        function pressKey(key) {
            if (!gameRunning || !currentSpell) return;
            if (usedKeys.includes(key)) return;

            usedKeys.push(key);
            updateKeyboard();

            const targetLetter = currentSpell.english[currentInput.length];

            if (key === targetLetter) {
                currentInput += key;
                updateSpellDisplay(true);
                createParticle(true);

                if (currentInput === currentSpell.english) {
                    // Spell complete!
                    spellComplete();
                }
            } else {
                // Wrong letter
                updateSpellDisplay(false);
                createParticle(false);
                lives--;

                if (lives <= 0) {
                    // Show correct answer briefly then next spell
                    showCorrectAnswer();
                }
            }
        }

        function updateSpellDisplay(correct) {
            const container = document.getElementById('spellLetters');
            const letters = currentSpell.english.split('');

            container.innerHTML = letters.map((letter, i) => {
                let className = 'letter-box';
                if (i < currentInput.length) {
                    className += ' filled correct';
                } else if (i === currentInput.length && !correct) {
                    className += ' wrong';
                }
                return `<div class="${className}">${i < currentInput.length ? currentInput[i] : ''}</div>`;
            }).join('');
        }

        function updateKeyboard() {
            document.querySelectorAll('.key').forEach(key => {
                if (usedKeys.includes(key.dataset.key)) {
                    key.classList.add('used');
                } else {
                    key.classList.remove('used');
                }
            });
        }

        function spellComplete() {
            const points = currentSpell.english.length * 10 + lives * 20;
            score += points;
            spellsCompleted++;

            if (spellsCompleted % 3 === 0) {
                level++;
            }

            showResult(`${currentSpell.effect} ${currentSpell.name}!`);
            createMagicBurst();

            setTimeout(() => {
                nextSpell();
            }, 1500);

            updateUI();
        }

        function showCorrectAnswer() {
            const container = document.getElementById('spellLetters');
            const letters = currentSpell.english.split('');

            container.innerHTML = letters.map(letter =>
                `<div class="letter-box filled wrong">${letter}</div>`
            ).join('');

            setTimeout(() => {
                nextSpell();
            }, 1500);
        }

        function nextSpell() {
            currentSpell = spells[Math.floor(Math.random() * spells.length)];
            currentInput = '';
            usedKeys = [];
            lives = 3;

            document.getElementById('spellName').textContent = currentSpell.name;
            document.getElementById('spellHint').textContent = currentSpell.hint;
            updateSpellDisplay(true);
            updateKeyboard();
        }

        function showResult(text) {
            const popup = document.getElementById('resultPopup');
            popup.textContent = text;
            popup.classList.add('show');
            setTimeout(() => popup.classList.remove('show'), 1500);
        }

        function createParticle(success) {
            const container = document.getElementById('particles');
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.textContent = success ? '‚ú®' : 'üíî';
            particle.style.left = Math.random() * window.innerWidth + 'px';
            particle.style.top = (window.innerHeight / 2) + 'px';
            container.appendChild(particle);
            setTimeout(() => particle.remove(), 1000);
        }

        function createMagicBurst() {
            const container = document.getElementById('particles');
            for (let i = 0; i < 10; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    particle.textContent = ['‚ú®', '‚≠ê', 'üí´', 'üåü'][Math.floor(Math.random() * 4)];
                    particle.style.left = (window.innerWidth / 2 + (Math.random() - 0.5) * 200) + 'px';
                    particle.style.top = (window.innerHeight / 2 + (Math.random() - 0.5) * 100) + 'px';
                    container.appendChild(particle);
                    setTimeout(() => particle.remove(), 1000);
                }, i * 50);
            }
        }

        function updateUI() {
            document.getElementById('score').textContent = score;
            document.getElementById('level').textContent = level;
        }

        function draw() {
            // Dark magical background
            ctx.fillStyle = '#1a1a2e';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Stars
            ctx.fillStyle = '#ffd700';
            for (let i = 0; i < 50; i++) {
                const x = (i * 137) % canvas.width;
                const y = (i * 97) % canvas.height;
                const size = 1 + Math.sin(Date.now() / 1000 + i) * 0.5;
                ctx.beginPath();
                ctx.arc(x, y, size, 0, Math.PI * 2);
                ctx.fill();
            }

            // Wand in center
            ctx.font = '60px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';

            const wobble = Math.sin(Date.now() / 500) * 5;
            ctx.save();
            ctx.translate(canvas.width / 2, canvas.height / 2 + 50);
            ctx.rotate(wobble * Math.PI / 180);
            ctx.fillText('ü™Ñ', 0, 0);
            ctx.restore();

            // Magic glow
            if (gameRunning && currentInput.length > 0) {
                const gradient = ctx.createRadialGradient(
                    canvas.width / 2, canvas.height / 2,
                    0,
                    canvas.width / 2, canvas.height / 2,
                    100 + currentInput.length * 20
                );
                gradient.addColorStop(0, 'rgba(255, 215, 0, 0.3)');
                gradient.addColorStop(1, 'rgba(255, 215, 0, 0)');
                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(canvas.width / 2, canvas.height / 2, 100 + currentInput.length * 20, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function startGame() {
            document.getElementById('startScreen').classList.add('hide');
            initGame();
        }

        function restartGame() {
            document.getElementById('gameOverScreen').classList.remove('show');
            initGame();
        }

        function initGame() {
            score = 0;
            level = 1;
            spellsCompleted = 0;
            lives = 3;

            createKeyboard();
            nextSpell();
            gameRunning = true;
            updateUI();
        }

        function gameLoop() {
            draw();
            requestAnimationFrame(gameLoop);
        }

        createKeyboard();
        gameLoop();
    </script>
</body>
</html>
